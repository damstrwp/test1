import sqlite3

conn = sqlite3.connect('kinobot.db')
cursor = conn.cursor()
cursor.execute('''
    CREATE TABLE IF NOT EXISTS films(
        id INTEGER PRIMARY KEY autoincrement,
        film TEXT,
        genre TEXT,
        year TEXT,
        country TEXT,
        director TEXT,
        about TEXT,
        photo TEXT
    )

''')
conn.commit()

cursor.execute('''
    INSERT INTO films (film, genre, year, country, director,about,photo)
    VALUES
    ("<b><u>Крестный отец</u></b>","Криминал","1970-е","США","Фрэнсис Форд Коппола","Эпичная сага о сицилийской мафиозной семье. Фильм о власти, предательстве и семейных ценностях.","img/1.jpg"),
    ("<b><u>Криминальное чтиво</u></b>","Криминал","1990-е","США","Квентин Тарантино","Неординарная история бандитов с нелинейным повествованием. Наполнен фирменными диалогами и черным юмором.","img/2.jpg"),
    ("<b><u>Побег из Шоушенка</u></b>","Драма","1990-е","США","Фрэнк Дарабонт","История невиновного банкира, приговоренного к пожизненному сроку. Фильм о надежде и дружбе в неволе.","img/3.jpg"),
    ("<b><u>Форрест Гамп</u></b>","Драма","1990-е","США","Роберт Земекис","Жизненный путь простодушного, но доброго человека. Через его судьбу показана история Америки второй половины XX века.","img/4.jpg"),
    ("<b><u>Начало</u></b>","Фантастика","2010-е","США","Кристофер Нолан","Захватывающее путешествие в мир снов и подсознания. Гениальный вор идей сталкивается с неожиданными препятствиями.","img/5.jpg"),
    ("<b><u>Леон</u></b>","Боевик","1990-е","Франция","Люк Бессон","Профессиональный убийца берет под опеку девочку-сироту. Неожиданный дуэт мстителя и наемника.","img/6.jpg"),
    ("<b><u>1+1</u></b>","Комедия","2010-е","Франция","Оливье Накаш, Эрик Толедано","Богатый паралитик нанимает в помощники бывшего заключенного. Трогательная история необычной дружбы.","img/7.jpg"),
    ("<b><u>Старикам тут не место</u></b>","Триллер","2000-е","США","Братья Коэн","Мрачная история о деньгах, убийствах и роковых решениях. Фильм о том, как случай меняет судьбы людей.","img/8.jpg"),
    ("<b><u>Пила</u></b>","Ужасы","2000-е","США","Джеймс Ван","Люди просыпаются в смертельной ловушке маньяка. Чтобы выжить, им предстоит сделать невозможный выбор.","img/9.jpg"),
    ("<b><u>Ходячий замок</u></b>","Мультфильм","2000-е","Япония","Хаяо Миядзаки","Волшебная сказка о заколдованной девушке и бродячем замке. История о любви, войне и внутренней красоте.","img/10.jpg"),
    ("<b><u>Король Лев</u></b>","Мультфильм","1990-е","США","Роджер Аллерс, Роб Минкофф","Эпичная история взросления львенка Симбы. Анимационный шедевр с потрясающей музыкой.","img/11.jpg"),
    ("<b><u>Гравитация</u></b>","Фантастика","2010-е","США","Альфонсо Куарон","Астронавты борются за выживание после катастрофы на орбите. Напряженный фильм о человеческом духе в экстремальных условиях.","img/12.jpg"),
    ("<b><u>Дюна</u></b>","Фантастика","2020-е","США","Дени Вильнёв","Эпичная сага о борьбе за власть на пустынной планете. Визуально потрясающая экранизация культового романа.","img/13.jpg"),
    ("<b><u>Титаник</u></b>","Мелодрама","1990-е","США","Джеймс Кэмерон","История любви на фоне крушения легендарного лайнера. Один из самых кассовых фильмов в истории кино.","img/14.jpg"),
    ("<b><u>Матрица</u></b>","Боевик","1990-е","США","Лилли и Лана Вачовски","Хакер узнает шокирующую правду о реальном мире. Революционный фильм, изменивший представление о жанре.","img/15.jpg"),
    ("<b><u>Достать ножи</u></b>","Детектив","2010-е","США","Райан Джонсон","Загадочное убийство в особняке известного писателя. Остроумный современный взгляд на классический детектив.","img/16.jpg"),
    ("<b><u>Паразиты</u></b>","Триллер","2010-е","Южная Корея","Пон Чжун Хо","Бедная семья внедряется в жизнь богачей. Остросоциальная драма с неожиданными поворотами.","img/17.jpg"),
    ("<b><u>Брат</u></b>","Криминал","1990-е","Россия","Алексей Балабанов","Дембель возвращается домой и втягивается в криминальные разборки. Культовый фильм 90-х о российской действительности.","img/18.jpg"),
    ("<b><u>Один дома</u></b>","Комедия","1990-е","США","Крис Коламбус","Мальчик случайно остается один дома на Рождество. Классическая семейная комедия с забавными ловушками для грабителей.","img/19.jpg"),
    ("<b><u>Призрак в доспехах</u></b>","Аниме","1990-е","Япония","Мамору Осии","Киберполицейская расследует загадочные киберпреступления. Философский футуристический триллер с глубоким смыслом.","img/20.jpg"),
    ("<b><u>Зеленая миля</u></b>","Драма","1990-е","США","Фрэнк Дарабонт","Трогательная история надзирателя и необычного заключенного. Фильм о чудесах и жестокости человеческой природы.","img/21.jpg"),
    ("<b><u>Назад в будущее</u></b>","Фантастика","1980-е","США","Роберт Земекис","Подросток случайно попадает в прошлое на машине времени. Захватывающее приключение с юмором и неожиданными поворотами.","img/22.jpg"),
    ("<b><u>Темный рыцарь</u></b>","Боевик","2000-е","США","Кристофер Нолан","Бэтмен противостоит своему самому опасному врагу - Джокеру. Мрачный и глубокий взгляд на природу героизма и хаоса.","img/23.jpg"),
    ("<b><u>Карты, деньги, два ствола</u></b>","Криминал","1990-е","Великобритания","Гай Ричи","Запутанная история с переплетенными судьбами лондонских бандитов. Динамичный фильм с фирменным британским юмором.","img/24.jpg"),
    ("<b><u>Пятый элемент</u></b>","Фантастика","1990-е","Франция","Люк Бессон","Таксист становится ключевой фигурой в спасении Земли. Красочный космический блокбастер с уникальным стилем.","img/25.jpg"),
    ("<b><u>Фарго</u></b>","Триллер","1990-е","США","Братья Коэн","Абсурдная история похищения, которая пошла не по плану. Черная комедия с элементами криминальной драмы.","img/26.jpg"),
    ("<b><u>Отступники</u></b>","Криминал","2000-е","США","Мартин Скорсезе","Полицейский внедряется в мафию, а гангстер - в полицию. Напряженный криминальный триллер с блестящим актерским составом.","img/27.jpg"),
    ("<b><u>Заклятие</u></b>","Ужасы","2010-е","США","Джеймс Ван","Семья сталкивается с паранормальными явлениями в новом доме. Один из лучших современных фильмов ужасов, основанный на реальных событиях.","img/28.jpg"),
    ("<b><u>Унесенные призраками</u></b>","Мультфильм","2000-е","Япония","Хаяо Миядзаки","Девочка попадает в таинственный мир духов. Волшебная сказка с глубоким философским подтекстом.","img/29.jpg"),
    ("<b><u>Тайна Коко</u></b>","Мультфильм","2010-е","США","Ли Анкрич","Мальчик отправляется в Страну Мертвых, чтобы раскрыть семейную тайну. Трогательная история о памяти и важности семьи.","img/30.jpg"),
    ("<b><u>Марсианин</u></b>","Фантастика","2010-е","США","Ридли Скотт","Астронавт вынужден выживать в одиночку на Красной планете. Оптимистичная история человеческого интеллекта и воли к жизни.","img/31.jpg"),
    ("<b><u>Чужой</u></b>","Ужасы","1970-е","США","Ридли Скотт","Экипаж космического корабля сталкивается с идеальным убийцей. Классика научно-фантастического хоррора с атмосферой страха.","img/32.jpg"),
    ("<b><u>Достать ножи: Стеклянная луковица</u></b>","Детектив","2020-е","США","Райан Джонсон","Миллиардер собирает друзей на острове для смертельной игры. Запутанный детектив с неожиданной развязкой.","img/33.jpg"),
    ("<b><u>Семь</u></b>","Триллер","1990-е","США","Дэвид Финчер","Два детектива охотятся за серийным убийцей, совершающим преступления по мотивам семи смертных грехов. Мрачный и атмосферный триллер.","img/34.jpg"),
    ("<b><u>Ла-Ла Ленд</u></b>","Мелодрама","2010-е","США","Дэмьен Шазелл","История любви джазового музыканта и начинающей актрисы. Современный мюзикл с потрясающими музыкальными номерами.","img/35.jpg"),
    ("<b><u>Охота</u></b>","Драма","2010-е","Дания","Томас Винтерберг","Учитель становится жертвой ложного обвинения. Жесткая драма о хрупкости репутации и силе предрассудков.","img/36.jpg"),
    ("<b><u>Догвилль</u></b>","Драма","2000-е","Дания","Ларс фон Триер","Молодая женщина скрывается в маленьком городке от гангстеров. Экспериментальный фильм с минималистичными декорациями.","img/37.jpg"),
    ("<b><u>Движение вверх</u></b>","Драма","2010-е","Россия","Антон Мегердичев","История легендарной победы советских баскетболистов над американцами. Спортивная драма, основанная на реальных событиях.","img/38.jpg"),
    ("<b><u>Брюс Всемогущий</u></b>","Комедия","2000-е","США","Том Шэдьяк","Обычный репортер получает божественные силы. Забавная комедия с моралью о важности ответственности.","img/39.jpg"),
    ("<b><u>Акира</u></b>","Аниме","1980-е","Япония","Кацухиро Отомо","Мотоциклист попадает в центр правительственного заговора. Культовый футуристический аниме-шедевр.","img/40.jpg"),
    ("<b><u>Волк с Уолл-стрит</u></b>","Драма","2010-е","США","Мартин Скорсезе","Взлет и падение брокера-мошенника. Энергичная драма о жадности и разврате финансового мира.","img/41.jpg"),
    ("<b><u>Однажды в Голливуде</u></b>","Драма","2010-е","США","Квентин Тарантино","История актера и его каскадера на фоне Голливуда 1969 года. Ностальгический фильм с фирменным стилем Тарантино.","img/42.jpg"),
    ("<b><u>Игра в имитацию</u></b>","Драма","2010-е","Великобритания","Мортен Тильдум","Биография Алана Тьюринга, расшифровавшего код нацистов. Драма о гении, которого не поняло общество.","img/43.jpg"),
    ("<b><u>Социальная сеть</u></b>","Драма","2010-е","США","Дэвид Финчер","История создания Facebook и конфликтов между основателями. Острый взгляд на природу успеха и предательства.","img/44.jpg"),
    ("<b><u>Зеленая книга</u></b>","Драма","2010-е","США","Питер Фаррелли","Путешествие афроамериканского пианиста и его телохранителя по югу США 1960-х. Трогательная история дружбы через расовые барьеры.","img/45.jpg"),
    ("<b><u>Запах женщины</u></b>","Драма","1990-е","США","Мартин Брест","Слепой отставной офицер берет с собой в Нью-Йорк молодого помощника. Фильм о жизнелюбии и человеческом достоинстве.","img/46.jpg"),
    ("<b><u>Ирония судьбы, или С лёгким паром!</u></b>","Комедия","1970-е","СССР","Эльдар Рязанов","Мужчина по ошибке оказывается в чужой квартире в другом городе. Классическая новогодняя комедия о случайностях и любви.","img/47.jpg"),
    ("<b><u>Девчата</u></b>","Комедия","1960-е","СССР","Юрий Чулюкин","История любви молодого повара и лесоруба в тайге. Советская комедия с прекрасными актерскими работами.","img/48.jpg"),
    ("<b><u>Человек с бульвара Капуцинов</u></b>","Комедия","1980-е","СССР","Алла Сурикова","Киномеханик приезжает в дикий запад с кинопленками. Ироничная сказка о силе искусства.","img/49.jpg"),
    ("<b><u>Мальчишник в Вегасе</u></b>","Комедия","2000-е","США","Тодд Филлипс","Четверо друзей устраивают незабываемый мальчишник в Лас-Вегасе. Безумная комедия с неожиданными последствиями.","img/50.jpg"),
    ("<b><u>Реинкарнация</u></b>","Ужасы","2000-е","Япония","Такаси Симидзу","Журналистка исследует серию загадочных смертей. Жуткий фильм ужасов в лучших традициях J-horror.","img/51.jpg"),
    ("<b><u>Хэллоуин</u></b>","Ужасы","1970-е","США","Джон Карпентер","Маньяк сбегает из психушки и возвращается в родной город. Классический слэшер, задавший стандарты жанра.","img/52.jpg"),
    ("<b><u>Ветер крепчает</u></b>","Аниме","2010-е","Япония","Хаяо Миядзаки","История авиаконструктора Дзиро Хирокоси. Лирическая драма о мечтах, любви и войне.","img/53.jpg"),
    ('<b><u>Операция "Ы"</u></b>',"Комедия","1960-е","СССР","Леонид Гайдай","Трое друзей попадают в нелепые ситуации на стройке. Легендарная советская комедия с гэгами.","img/54.jpg"),
    ("<b><u>Бриллиантовая рука</u></b>","Комедия","1960-е","СССР","Леонид Гайдай","Неудачливый турист случайно становится контрабандистом. Одна из самых цитируемых советских комедий.","img/55.jpg"),
    ("<b><u>Мстители: Финал</u></b>","Боевик","2010-е","США","Энтони и Джо Руссо","Герои объединяются для последней битвы с Таносом. Грандиозный финал 22-фильмовой саги Marvel.","img/56.jpg"),
    ("<b><u>Топ Ган: Мэверик</u></b>","Боевик","2020-е","США","Джозеф Косински",'Пит "Мэверик" Митчелл возвращается в школу морских летчиков. Захватывающий сиквел с потрясающими воздушными сценами.',"img/57.jpg"),
    ("<b><u>Касабланка</u></b>","Драма","1940-е","США","Майкл Кертиц","Владелец бара в Касабланке сталкивается с прошлой любовью. Вечная классика о любви и жертвах во время войны.","img/58.jpg"),
    ("<b><u>Унесенные ветром</u></b>","Драма","1930-е","США","Виктор Флеминг","История жизни Скарлетт О'Хары на фоне Гражданской войны. Эпичная киносага о любви и выживании.","img/59.jpg"),
    ("<b><u>Таксист</u></b>","Драма","1970-е","США","Мартин Скорсезе","Ветеран Вьетнама работает таксистом в криминальном Нью-Йорке. Мрачный портрет одиночества и насилия в большом городе.","img/60.jpg"),
    ("<b><u>Красота по-американски</u></b>","Драма","1990-е","США","Сэм Мендес",'Среднестатистический американец переживает кризис среднего возраста. Ироничный и глубокий взгляд на "американскую мечту".',"img/61.jpg"),
    ("<b><u>Пушки Акимбо</u></b>","Боевик","2020-е","США","Илья Найшуллер","Офисный работник (Дэниэл Рэдклифф) мстит бандитам, используя необычные навыки. Безумный экшен с абсурдным юмором и стильными боями.","img/62.jpg"),
    ("<b><u>Реквием по мечте</u></b>","Драма","2000-е","США","Даррен Аронофски","Жесткая история о зависимостях и разрушенных мечтах. Визуально мощный фильм о человеческом отчаянии.","img/63.jpg"),
    ("<b><u>Коралина в Стране Кошмаров</u></b>","Мультфильм","2000-е","США","Генри Селик","Девочка обнаруживает потайную дверь в параллельный мир. Темная сказка в уникальной стилистике stop-motion.","img/64.jpg"),
    ("<b><u>Эдвард Руки-ножницы</u></b>","Фэнтези","1990-е","США","Тим Бёртон","История искусственного человека с ножницами вместо рук. Трогательная сказка об отчуждении и любви.","img/65.jpg"),
    ("<b><u>Железный человек</u></b>","Боевик","2000-е","США","Джон Фавро","История превращения гениального миллиардера в супергероя. Фильм, положивший начало вселенной Marvel.","img/66.jpg"),
    ("<b><u>Мстители</u></b>","Боевик","2010-е","США","Джосс Уидон","Первая сборка легендарной команды супергероев. Эпохальный кроссовер Marvel.","img/67.jpg"),
    ("<b><u>Черная Пантера</u></b>","Боевик","2010-е","США","Райан Куглер","Первый супергеройский фильм с африканским героем. Культурный феномен с глубоким социальным подтекстом.","img/68.jpg"),
    ("<b><u>Стражи Галактики</u></b>","Фантастика","2010-е","США","Джеймс Ганн","Команда неудачников спасает вселенную под хиты 70-х. Самый необычный и музыкальный проект Marvel.","img/69.jpg"),
    ("<b><u>Маска</u></b>","Комедия","1990-е","США","Чак Расселл","Неудачник Стэнли Ипкисс находит магическую маску, превращающую его в харизматичного супергероя. Безумная комедия с Джимом Керри в главной роли.","img/70.jpg"),
    ("<b><u>Чудо-женщина</u></b>","Боевик","2010-е","США","Патти Дженкинс","Первая полноценная экранизация приключений Дианы. Вдохновляющий женский супергеройский фильм.","img/71.jpg"),
    ("<b><u>Аквамен</u></b>","Фантастика","2010-е","США","Джеймс Ван","История становления короля подводного царства. Визуально потрясающий подводный эпос.","img/72.jpg"),
    ("<b><u>Отряд самоубийц</u></b>","Боевик","2010-е","США","Дэвид Эйер","Группа суперзлодеев выполняет опасные миссии. Энергичный и нестандартный взгляд на вселенную DC.","img/73.jpg"),
    ("<b><u>Тор: Рагнарёк</u></b>","Фантастика","2010-е","США","Тайка Вайтити","Самый необычный и комедийный фильм о боге грома. Яркий космический приключенческий фильм.","img/74.jpg"),
    ("<b><u>Человек-паук: Нет пути домой</u></b>","Боевик","2020-е","США","Джон Уоттс","Питер Паркер сталкивается с мультивселенными. Эпичный кроссовер с героями разных эпох.","img/75.jpg"),
    ("<b><u>Джокер</u></b>","Триллер","2010-е","США","Тодд Филлипс","Несостоявшийся комик Артур Флек погружается в безумие и становится иконой анархии. Мрачное переосмысление происхождения главного злодея DC.","img/76.jpg"),
    ("<b><u>Лига справедливости</u></b>","Боевик","2010-е","США","Зак Снайдер","Сборка главных героев DC для борьбы с апокалипсисом. Грандиозный кроссовер вселенной DC.","img/77.jpg")

    ''')
conn.commit()


def add_film(film, genre, year, country, director, about, photo):
    cursor.execute('''
        INSERT INTO films (film,genre,year,country,director,about,photo)
        VAlUES (?,?,?,?,?,?,?)
    ''', (film, genre, year, country, director, about, photo))


def get_film(genre, year):
    cursor.execute('''
        SELECT film,genre,year,country,director,about FROM films 
        WHERE genre = ? AND year = ?
    ''', (genre, year))  # Передаем параметры кортежем
    return cursor.fetchall()  # Возвращаем все найденные записи


def get_film_genre(genre):
    cursor.execute('''
        SELECT film,genre,year,country,director,about FROM films 
        WHERE genre = ?
    ''', (genre,))  # Передаем параметры кортежем
    return cursor.fetchall()  # Возвращаем все найденные записи


def get_film_year(year):
    cursor.execute('''
        SELECT film,genre,year,country,director,about FROM films 
        WHERE year = ?
    ''', (year,))  # Передаем параметры кортежем
    return cursor.fetchall()  # Возвращаем все найденные записи


def get_randfilm(id):
    cursor.execute('''
        SELECT film,genre,year,country,director,about FROM films 
        WHERE id = ?
    ''', (id,))  # Передаем параметры кортежем
    return cursor.fetchall()  # Возвращаем все найденные записи


def get_film_name(film):
    cursor.execute('''
        SELECT film,genre,year,country,director,about FROM films 
        WHERE film = ?
    ''', (film,))  # Передаем параметры кортежем
    return cursor.fetchall()  # Возвращаем все найденные записи


def get_photo(id):
    cursor.execute('''
        SELECT photo FROM films 
        WHERE id = ?
    ''', (id,))  # Передаем параметры кортежем
    return cursor.fetchall()  # Возвращаем все найденные записи


def get_photo_name(film):
    cursor.execute('''
        SELECT photo FROM films 
        WHERE film = ?
    ''', (film,))  # Передаем параметры кортежем
    return cursor.fetchall()  # Возвращаем все найденные записи


def maximum():
    cursor.execute('''SELECT MAX(id) FROM films''')
    max_id = cursor.fetchone()[0]  # Получаем первое значение из результата
    return max_id if max_id else 0


test = cursor.execute('''
select * FROM films''')
conn.commit()

print(test.fetchall())
